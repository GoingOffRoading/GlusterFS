# Gluster v9.x 
# Ubuntu image instead of Alpine for install simplicty of Launchpad: https://launchpad.net/~gluster/+archive/ubuntu/glusterfs-9

FROM ubuntu:latest
MAINTAINER Chase Westlye <cwestlye@gmail.com>
LABEL org.opencontainers.image.source=https://github.com/goingoffroading/glusterfs

# Install Gluster + dependancies 
RUN apt-get update && \
    apt-get install -y software-properties-common && \
    add-apt-repository ppa:gluster/glusterfs-9 && \
    apt-get update && \
    apt-get install -y glusterfs-server

#/data for mounting data
#/var/lib/glusterd for the Gluster config
VOLUME ["/data", "/var/lib/glusterd"]

#Ports list from the original repo: https://github.com/gluster/gluster-containers/blob/master/CentOS/Dockerfile
#EXPOSE 2222 111 245 443 24007 2049 8080 6010 6011 6012 38465 38466 38468 38469 49152 49153 49154 49156 49157 49158 49159 49160 49161 49162

#COPY /gluster-entrypoint.sh /
#RUN chmod +x /gluster-entrypoint.sh
#ENTRYPOINT [ "/bin/bash", "/gluster-entrypoint.sh" ]

#To hold the container open
#CMD ["glusterd", "-N", "--log-file=/dev/stdout"]
#CMD ["glusterd"]
#CMD ["glusterd peer status"]
CMD ["/usr/sbin/glusterd","-N"]